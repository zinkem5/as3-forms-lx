<html>
<script>
var req = new XMLHttpRequest();
req.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      console.log(req.responseText);
       document.body.innerHTML = req.responseText;
    }
};

var method = 'GET';
let action = 'list';
var body = '';

console.log(window.location.search);

if( window.location.search ) {
  let q = window.location.search.substring(1).split('&')
    .map(x => x.split('='))
    .reduce((a, c) => {
      a[c[0]] = c[1];
      return a;
    }, {});
    console.log(q);

    if( q.post ) {
      method = 'POST';
      Object.keys(q).forEach(k => {
        if( q[k] === 'on' )
          q[k] = true;
      });
      body = JSON.stringify(q);
    }

    if( q.hasOwnProperty('declaration') ) {
      action = 'declaration'
      console.log('woot!')
    }

    if( q.template )
      action = q.template

    if( q.application_name && q.tenant_name && !q.template) {
      action = `declaration/${q.tenant_name}/${q.application_name}`
    }
}

req.open(method, "/mgmt/shared/as3-forms-lx/"+action, true);
req.send(body);
</script>
<body>
</body>
</html>
